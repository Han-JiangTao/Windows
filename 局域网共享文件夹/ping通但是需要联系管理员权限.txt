在共享打印机的那台电脑上
1.“我的电脑”右键－管理－本地用户和组－用户－启用来宾

2.运行里输入secpol.msc启动“本地安全设置”－“安全选项”－“网络访问：本地账户的共享和安全模式”－将“经典”改为“仅来宾”。

3.运行里输入secpol.msc启动“本地安全设置”－“用户权利指派”－将“拒绝作为服务器和批作业”里面的用户删除

4.运行里输入secpol.msc启动本地安全设置”－“安全选项”－“网络访问：不允许SAM帐户和共享的匿名枚举-禁用
注意：以上设置需重启后生效